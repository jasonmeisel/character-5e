<head>
  <title>D&amp;D 5e Character Builder</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
</head>

<body>
  <div class="container">
    <div>
      <h1>D&amp;D 5e Character Builder</h1>
      <p class="lead">Make your characters using modern technology</p>
    </div>

    {{> character_list}}
  </div>
</body>

<template name="character_list">
  {{#each all_characters}}
    {{> character_sheet this}}
  {{/each}}

  <button id="new_character">New Character</button>
</template>

<template name="character_sheet">
  <div class="character_sheet panel panel-default">
    <label>Character name</label>
    <p>{{> editableText collection="CharacterDB" field="name"}}</p>

    <label>Player name</label>
    <p>{{> editableText collection="CharacterDB" field="playerName"}}</p>

    <label>Race</label>
    <p>
      <div class="input-group">
        {{> editableText collection="CharacterDB" field="race" class="form-control race_box"}}
        <div class="input-group-btn">
          <button type="button" class="btn btn-default btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button>
          <ul class="dropdown-menu races_dropdown" role="menu">
            {{#each all_races}}
              <li><a href="#">{{this}}</a></li>
            {{/each}}
          </ul>
        </div>
      </div>
    </p>

    <label>Class</label>
    <p class="dropdown">
      {{#each key_value classes}}
        {{> class_element}}
      {{/each}}
      <button
        class="btn btn-default btn-sm glyphicon glyphicon-plus"
        id="add_class_button" data-toggle="dropdown"
        aria-haspopup="true" aria-expanded="false"></button>
      <ul id="add_classes_menu" class="dropdown-menu" role="menu" aria-labelledby="add_class_button">
        {{#each new_classes}}
          <li role="presentation"><a class="add_classes_select" role="menuitem" tabindex="-1" href="#">{{this}}</a></li>
        {{/each}}
      </ul>
    </p>

    <label>Background</label>
    <p>{{> editableText collection="CharacterDB" field="background"}}</p>

    <label>Alignment</label>
    <p>{{> editableText collection="CharacterDB" field="alignment"}}</p>

    <label>Experience points</label>
    <p>{{> editableText collection="CharacterDB" field="xp"}}</p>

    <label>Strength ({{to_modifier abilities.strength}})</label>
    <p>{{> editableText collection="CharacterDB" field="abilities.strength"}}</p>

    <label>Dexterity ({{to_modifier abilities.dexterity}})</label>
    <p>{{> editableText collection="CharacterDB" field="abilities.dexterity"}}</p>

    <label>Constitution ({{to_modifier abilities.constitution}})</label>
    <p>{{> editableText collection="CharacterDB" field="abilities.constitution"}}</p>

    <label>Intelligence ({{to_modifier abilities.intelligence}})</label>
    <p>{{> editableText collection="CharacterDB" field="abilities.intelligence"}}</p>

    <label>Wisdom ({{to_modifier abilities.wisdom}})</label>
    <p>{{> editableText collection="CharacterDB" field="abilities.wisdom"}}</p>

    <label>Charisma ({{to_modifier abilities.charisma}})</label>
    <p>{{> editableText collection="CharacterDB" field="abilities.charisma"}}</p>
  </div>
</template>

<template name="class_element">
  <div class="class_element btn-group btn-group-xs" role="group">
    <button class="btn btn-default btn-xs">{{key}} {{value}}</button>
    <button class="btn btn-primary btn-xs glyphicon glyphicon-plus add_level" className="{{key}}"></button>
    <button class="btn btn-danger btn-xs glyphicon glyphicon-minus remove_level" className="{{key}}"></button>
  </div>
</template>
